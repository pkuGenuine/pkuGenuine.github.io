# Machine Learning

## SVM

### Conditional Extremum

Read this [blog](https://www.zhihu.com/question/38586401) first.

It is hard to express math ideas in English, so I'll use Chinese first. If I have time later, I'll convert it to English......

博客里很重要的一个点：拉格朗日多项式只是一个等价形式，本质还是梯度方向要与约束条件构成的 线/面/超面 的法线平行。以及法线其实也是个梯度。考虑二维空间上的约束，一根线其实就是 $h(x) = 0$ 的边界，在任一点的法线其实就是其梯度，沿梯度方向值会下降，不再是 0 点，沿切线方向或者垂直于梯度的方向，偏导为 0，值保持为 0 。

对于一个凸问题，考虑最小值。极值点应当在梯度为 0 处取到，或者在边界处取到。

由于有约束条件，小概率能取到梯度为 0 的点，但更可能的是无法取到梯度为 0 的点，极值可能在边界处取到。对于等式约束的情况，等式会限制取值为一个超平面，这一个超平面上都是“边界”。枚举相当于什么也没做，还是个条件极值问题。

正如博客所说，当目标函数在超平面上某一点的梯度与超平面法向平行的时候，达到极值。否则超平面上一定有一个方向和梯度方向角度 < 90。注意，与梯度方向垂直的方向偏导都是 0，又由于凸函数的性质，连续等等，那个方向上的微分一定是负的，导致该点不是极值点。

对于不等式的情况，其实也类似，极值点只能在边界处取到，类似于等式的情况，但是对梯度的方向有了进一步限制。梯度应该和不等式所包括的范围反向。

还有，对于多个约束条件的情况，其法线的线性组合与梯度相同时，取得极值，问题是，是什么样的线性组合，权值怎么分配。等式的情况，所有约束构成一个低纬度的边界，各个面/超面的法向都垂直于这个边界，其法向的线性组合也必然垂直于这个边界。所以，如果在某一点的梯度是个约束函数梯度的线性组合，则梯度垂直于约束边界，可以达到极值。

对于不等式的情况，除了相交的部分，约束条件各自的边界也有可能出现极值。出现极值的条件和之前类似，梯度平行。仍然是线性组合的问题。

对于不等式的情况，有时候需要考虑某些约束条件，有时候不考虑。有 [KKT](https://zhuanlan.zhihu.com/p/26514613) 约束可以用。

### Lagrangian Duality

等式约束情况下，拉格朗日多项式的极值与原函数极值相同，因为拉格朗日多项式达到极值时 h(x) 都是 0。但不等式情况下，拉格朗日多项式要求 $\lambda ≥ 0$，相当于有了约束条件，不能简单的通过梯度为 0 求得极值。此时考虑[对偶问题](https://www.zhihu.com/question/58584814)。 